# Example YAML to get you started quickly.
# Be aware that YAML has indentation based coping.
# Code completion support is available so start typing for available options.
swagger: '2.0'

# This is your document metadata
info:
  version: "1.0.0"
  title: TV Orders API
  description: |
    </br>
    Contiene los endpoints a web service necesarios para gestionar las ordenes de compra de
    productos vendidos por https://www.ofix.com.mx.
    </br>
    </br>
  contact: 
      name: API Support
      url: https://www.ofix.com.mx/privacyinfo 
      email: ti@ofix.mx
  termsOfService: https://www.ofix.com.mx/conditionsofuse
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  
host:
  localhost:5000
basePath: "/api/orders"
schemes:
  - http
  - https
consumes:
  - application/json
produces:
  - application/json
# Describe your paths here
tags: 
  - name: "Orders Header"
    description: "Endpoints a Header de Pedidos"
  - name: "Orders Detail"
    description: "Endpoints a Detalle de Pedidos"
  - name: "Orders Status"
    description: "Endpoints que manejan los estatus de Pedidos"
  - name: "Product Data"
    description: "Endpoint para obtener datos adicionales de productos de pedidos"
  - name: "Click and Collect Orders"
    description: "Endpoint para obtener los pedidos de Click & Collect"
paths:
  # This is a path endpoint. Change it.
  /id/header/:
    # This is a HTTP operation
    get:
      tags: 
        - "Orders Header"
      description: 
        Obtiene la cabecera de una orden a partir de un ID de pedido y el tipo de pedido.
      # This is array of GET operation parameters:
      parameters: 
        - name: OrderById
          in: body
          description: Payload para obtener el header de una orden a partir de su Id.
          required: true
          schema:
            $ref: '#/definitions/orderById'
      
      # Expected responses for this operation:
      responses:
        # Response code
        200:
          description: Successful response
          # A schema describing your response object.
          # Use JSON Schema format
          schema:
            type: array
            items:
              $ref: '#/definitions/OrderHeader'
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    post:
      tags: 
        - "Orders Header"
      description: 
        Inserta la cabecera de una orden en base de datos.   
      responses:
        # Response code
        200:
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/postOrderHeader'
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /id/detail/:
    # This is a HTTP operation
    get:
      tags: 
        - "Orders Detail"
      description: 
        Obtiene el detalle de una orden a partir de un ID de pedido y el tipo de pedido.
      # This is array of GET operation parameters:
      parameters: 
        - name: OrderById
          in: body
          description: Payload para obtener el detalle de una orden a partir de su Id.
          required: true
          schema:
            $ref: '#/definitions/orderById'
      # Expected responses for this operation:
      responses:
        # Response code
        200:
          description: Successful response
          # A schema describing your response object.
          # Use JSON Schema format
          schema:
            type: array
            items:
              $ref: '#/definitions/OrderDetail'
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    post:
      tags: 
        - "Orders Detail"
      description: 
        Inserta el detalle (partidas) de una orden en base de datos.      
      responses:
        # Response code
        200:
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/postOrderDetail'
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  /status/:
    get:
      tags: 
        - "Orders Status"
      description: 
        Obtiene el estatus de un pedido a partir de un Id y su tipo.
      parameters: 
        - name: OrderById
          in: body
          description: Payload para obtener el estatus de una orden a partir de su Id.
          required: true
          schema:
            $ref: '#/definitions/orderById'  
      responses:
        # Response code
        200:
          description: Successful response
          # A schema describing your response object.
          # Use JSON Schema format
          schema:
            type: array
            items:
              $ref: '#/definitions/OrderStatus'  
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    put:
      tags: 
        - "Orders Status"
      description: 
        Actualiza el estatus de un pedido a partir de un Id y su tipo.
      parameters: 
        - name: OrderStatus
          in: body
          description: Payload para actualizar el estatus de una orden a partir de su Id.
          required: true
          schema:
            $ref: '#/definitions/OrderStatus'  
      responses:
        # Response code
        200:
          description: Successful response
          # A schema describing your response object.
          # Use JSON Schema format
          schema:
            type: array
            items:
              $ref: '#/definitions/StatusOK'  
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
                  
  /list/cNc/:
    get:
      tags:
        - "Click and Collect Orders"
      description: 
        Obtiene listado de pedidos que aplican para click & collect
      responses:
        # Response code
        200:
          description: Successful response
          # A schema describing your response object.
          # Use JSON Schema format
          schema:
            type: array
            items:
              $ref: '#/definitions/OrderHeader'
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
          
  /productData/:
    get:
      tags:
        - "Product Data"
      description:
        Obtiene datos adicionales de productos a partir de SKU en el ERP.
      parameters: 
        - name: OrderById
          in: body
          description: Payload con SKU Ofix para busqueda de datos adicionales
          required: true
          schema:
            $ref: '#/definitions/productSku'
      responses:
        200:
          description: Successful response
          # A schema describing your response object.
          # Use JSON Schema format
          schema:
            title: SkuData
            type: array
            items:
              $ref: '#/definitions/SkuData'
        404:
          description: Page Not Found
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
          
definitions:
  orderById:
    allOf:
      - $ref: '#/definitions/orderById'
      - required:
        - order_id
        - order_type
        type: "object"
        properties:
          order_id:
            type: integer
            format: int64
          order_type:
            type: string
            format: string

  productSku:
    type: "object"
    required:
      - sku  
    properties:
      sku:
        type: string
      
  OrderHeader:
    allOf:
      - $ref: '#/definitions/OrderHeader'
      - required:
        - OrderId
        - RfcCliente
        - NombreCliente
        - NumeroCliente
        - Domicilio
        - Ciudad
        - Estado
        - CodigoPostal
        - Pais
        - TelefonoCliente
        - EmailCliente
        - ImportePedido
        - ImpuestoPedido
        - TotalPedido
        - FormaPago
        - MetodoPago
        - FechaPedido
        type: "object"
        properties:
          OrderId:
            type: number
            format: int64
          RfcCliente:
            type: string
          NombreCliente:
            type: string
          NumeroCliente:
            type: string
          Domicilio:
            type: string
          Ciudad:
            type: string
          Estado:
            type: string
          CodigoPostal:
            type: string
          Pais:
            type: string
          TelefonoCliente:
            type: string
          EmailCliente:
            type: string
          ImportePedido:
            type: number
            format: double
          ImpuestoPedido:
            type: number
            format: double
          TotalPedido:
            type: number
            format: double
          FormaPago:
            type: string
          MetodoPago:
            type: string
          FechaPedido:
            type: string
  
  OrderDetail:
    allOf:
      - $ref: '#/definitions/OrderDetail'
      - required:
        - OrderId
        - Cantidad
        - SKUProducto
        - NombreProducto
        - CodigoFabricante
        - UnidadMedida
        - ImporteUnitario
        - ImpuestoUnitario
        - TotalUnitario
        - DesctoUnitario
        - ImporteTotal
        - TotalOrder
        type: "object"
        properties:
          OrderId:
            type: integer
            format: int64
          Cantidad:
            type: integer
            format: int64
          SKUProducto:
            type: string
          NombreProducto: 
            type: string
          CodigoFabricante:
            type: string
          UnidadMedida:
            type: string
          ImporteUnitario: 
            type: number
            format: double
          ImpuestoUnitario: 
            type: number
            format: double
          TotalUnitario:
            type: number
            format: double
          DesctoUnitario: 
            type: number
            format: double
          ImporteTotal: 
            type: number
            format: double
          TotalOrder:
            type: number
            format: double
            
  postOrderHeader:
    allOf:
      - $ref: '#/definitions/postOrderHeader'
      - required:
        - tipo_pedido
        - orderid
        - orderguid
        - orderstatusid
        - paymentstatusid
        - shippingstatusid
        - customerlanguageid
        - customertaxdisplaytypeid
        - ordersubtotalincltax
        - ordersubtotalexcltax
        - ordersubtotaldiscountincltax
        - ordersubtotaldiscountexcltax
        - ordershippingincltax
        - ordershippingexcltax
        - paymethodaddfeeincltax
        - paymethodaddfeeexcltax
        - taxrates
        - ordertax
        - ordertotal
        - refundedamount
        - orderdiscount
        - currencyrate
        - customercurrencycode
        - affiliateid
        - affiliateurlfliendly
        - vatnumber
        - usocfdi
        - billingfirstname
        - billinglastname
        - billingemail
        - billingcrmid
        - billingcountryid
        - billingcountryname
        - billingstateprovinceid
        - billingstateprovincename
        - billingcity
        - billingaddress1
        - billingaddress2
        - billingzippostalcode
        - billingphonenumber
        - billingfaxnumber
        - paymentmethodsystemname
        - paiddateutc
        - shippingfirstname
        - shippinglastname
        - shippingemail
        - shippingcrmid
        - shippingcountryid
        - shippingcountryname
        - shippingstateprovinceid
        - shippingstateprovincename
        - shippingcity
        - shippingaddress1
        - shippingaddress2
        - shippingzippostalcode
        - shippingphonenumber
        - shippingfaxnumber
        - shippingmethod
        - shippingratecompmethodsysname
        - deleted
        - createdonutc
        - created_by
        - last_updated_by
        - pickupinstore
        type: "object"
        properties:
            tipo_pedido:
              type: string
            orderid:
              type: integer
              format: int64
            orderguid:
              type: string
            orderstatusid:
              type: integer
              format: int64
            paymentstatusid:
              type: integer
              format: int64
            shippingstatusid:
              type: integer
              format: int64
            customerlanguageid:
              type: integer
              format: int64
            customertaxdisplaytypeid:
              type: integer
              format: int64
            ordersubtotalincltax:
              type: number
              format: double
            ordersubtotalexcltax:
              type: number
              format: double
            ordersubtotaldiscountincltax:
              type: number
              format: double
            ordersubtotaldiscountexcltax:
              type: number
              format: double
            ordershippingincltax:
              type: number
              format: double
            ordershippingexcltax:
              type: number
              format: double
            paymethodaddfeeincltax:
              type: number
              format: double
            paymethodaddfeeexcltax:
              type: number
              format: double
            taxrates:
              type: string
            ordertax:
              type: number
              format: double
            ordertotal:
              type: number
              format: double
            refundedamount:
              type: number
              format: double
            orderdiscount:
              type: number
              format: double
            currencyrate:
              type: string
            customercurrencycode:
              type: string
            affiliateid:
              type: string
            affiliateurlfliendly:
              type: string
            vatnumber:
              type: string
            usocfdi:
              type: string
            billingfirstname:
              type: string
            billinglastname:
              type: string
            billingemail:
              type: string
            billingcrmid:
              type: string
            billingcountryid:
              type: integer
              format: int64
            billingcountryname:
              type: string
            billingstateprovinceid:
              type: integer
              format: int64
            billingstateprovincename:
              type: string
            billingcity:
              type: string
            billingaddress1:
              type: string
            billingaddress2:
              type: string
            billingzippostalcode:
              type: string
            billingphonenumber:
              type: string
            billingfaxnumber:
              type: string
            paymentmethodsystemname:
              type: string
            paiddateutc:
              type: string
            shippingfirstname:
              type: string
            shippinglastname:
              type: string
            shippingemail:
              type: string
            shippingcrmid:
              type: string
            shippingcountryid:
              type: integer
              format: int64
            shippingcountryname:
              type: string
            shippingstateprovinceid:
              type: integer
              format: int64
            shippingstateprovincename:
              type: string
            shippingcity:
              type: string
            shippingaddress1:
              type: string
            shippingaddress2:
              type: string
            shippingzippostalcode:
              type: string
            shippingphonenumber:
              type: string
            shippingfaxnumber:
              type: string
            shippingmethod:
              type: string
            shippingratecompmethodsysname:
              type: string
            deleted:
              type: string
            createdonutc:
              type: string
            created_by:
              type: string
            last_updated_by:
              type: string
            pickupinstore:
              type: boolean
  
  postOrderDetail:
    allOf:
      - $ref: '#/definitions/postOrderDetail'
      - required:
        - tipo_pedido
        - orderid
        - orderitemguid
        - productid
        - productname
        - sku
        - manufacturerpartnumber
        - vendorid
        - unitpriceincltax
        - unitpriceexcltax
        - priceincltax
        - priceexcltax
        - quantity
        - discountamountincltax
        - discountamountexcltax
        - created_by
        - last_updated_by
        - uom
        - line_number
        - inventory_item
        - inventory_item_id
        - tax_code
        type: "object"
        properties:
          tipo_pedido:
            type: string
          orderid:
            type: integer
            format: int64
          orderitemguid:
            type: string
          productid:
            type: string
          productname:
            type: string
          sku:
            type: string
          manufacturerpartnumber:
            type: string
          vendorid:
            type: integer
            format: int64
          unitpriceincltax:
            type: number
            format: double
          unitpriceexcltax:
            type: number
            format: double
          priceincltax:
            type: number
            format: double
          priceexcltax:
            type: number
            format: double
          quantity:
            type: integer
            format: int64
          discountamountincltax:
            type: number
            format: double
          discountamountexcltax:
            type: number
            format: double
          created_by:
            type: integer
            format: int64
          last_updated_by:
            type: integer
            format: int64
          uom:
            type: string
          line_number:
            type: integer
            format: int64
          inventory_item:
            type: string
          inventory_item_id:
            type: string
          tax_code:
            type: string
              
  OrderStatus:
    allOf:
      - $ref: '#/definitions/OrderStatus'
      - required:
        - OrderId
        - StatusPedido
        - TipoPedido
        type: "object" 
        properties:
          OrderId: 
            type: integer
            format: int64
          StatusPedido: 
            type: string
          TipoPedido:
            type: string
  
  StatusOK:
    allOf:
      - $ref: '#/definitions/StatusOK'
      - required:
        - OrderId
        - StatusOK
        - TipoPedido
        type: "object" 
        properties:
          OrderId: 
            type: integer
            format: int64
          StatusOK: 
            type: string
          TipoPedido:
            type: string
            
  SkuData:
    allOf:
      - $ref: '#/definitions/SkuData'
      - required:
        - Sku
        - InventoryItemId
        - UOM
        - TaxCode
        type: "object"
        properties:
          Sku:
            type: string
          InventoryItemId:
            type: integer
            format: int64
          UOM:
            type: string
          TaxCode:
            type: string
  
  Error:
    type: "object"
    required:
      - error_code
      - error_message
    properties:
      error_code:
        type: integer
        format: int32
      error_message:
        type: string